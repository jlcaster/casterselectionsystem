<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>江龙脚轮选型系统 - FABE话术生成器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <!-- 添加jQuery和LeanCloud脚本 -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- LeanCloud应用配置 -->
    <!-- 统计脚本 -->
    <script>
      // 更新为新的LeanCloud应用配置
      const VISITOR_CONFIG = {
        appId: "s1ElXHtFQO5FlOqFJ2nLX2L8-gzGzoHsz",
        appKey: "bT8sQEnJFE15P9xXQxo1aONN",
        serverURL: "https://s1elxhtf.lc-cn-n1-shared.com"
      };
      
      // 确保DOM加载完成后再初始化LeanCloud
      document.addEventListener('DOMContentLoaded', function() {
        if (typeof AV !== 'undefined') {
          AV.init(VISITOR_CONFIG);
          console.log('LeanCloud 初始化成功');
        } else {
          console.error('LeanCloud SDK加载失败');
          // 尝试重新加载SDK
          var script = document.createElement('script');
          script.src = 'https://cdn.jsdelivr.net/npm/leancloud-storage@4.13.2/dist/av-min.js';
          script.onload = function() {
            if (typeof AV !== 'undefined') {
              AV.init(VISITOR_CONFIG);
              console.log('LeanCloud SDK重新加载并初始化成功');
            }
          };
          document.head.appendChild(script);
        }
      });

    </script>
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.13.2/dist/av-min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #1a3a6c, #2c5282);
            color: white;
            padding: 25px 30px;
            position: relative;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            color: #ffcc00;
        }
        
        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 1px;
        }
        
        .logo-text p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .datetime-weather {
            text-align: right;
            background: rgba(255, 255, 255, 0.15);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.95rem;
        }
        
        .main-content {
            display: flex;
            padding: 0;
        }
        
        .input-section {
            flex: 0 0 380px;
            padding: 30px;
            background: #f8fafc;
            border-right: 1px solid #e2e8f0;
        }
        
        .result-section {
            flex: 1;
            padding: 30px;
            background: white;
            overflow: auto;
        }
        
        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #1a3a6c;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid #2c5282;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #2c5282;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .form-group .info-icon {
            position: absolute;
            right: 10px;
            top: 38px;
            color: #4299e1;
            cursor: pointer;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
            font-size: 0.95rem;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
        }
        
        .calculate-btn {
            background: linear-gradient(to right, #2b6cb0, #4299e1);
            color: white;
            border: none;
            padding: 14px 20px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .calculate-btn:hover {
            background: linear-gradient(to right, #2c5282, #3182ce);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(66, 153, 225, 0.3);
        }
        
        .formula-box {
            background: #edf2f7;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 0.95rem;
            border-left: 4px solid #4299e1;
        }
        
        .formula-box h3 {
            color: #2b6cb0;
            margin-bottom: 10px;
        }
        
        .result-container {
            margin-top: 25px;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 10px 18px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .generate-btn {
            background: linear-gradient(to right, #38a169, #48bb78);
            color: white;
            border: none;
        }
        
        .generate-btn:hover {
            background: linear-gradient(to right, #2f855a, #38a169);
            transform: translateY(-2px);
        }
        
        .copy-btn {
            background: linear-gradient(to right, #2b6cb0, #4299e1);
            color: white;
            border: none;
        }
        
        .copy-btn:hover {
            background: linear-gradient(to right, #2c5282, #3182ce);
            transform: translateY(-2px);
        }
        
        .schemes-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .scheme {
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
            min-height: 700px; /* 适当增大，保证内容对齐 */
        }
        
        .scheme:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .scheme.recommended {
            border: 2px solid #4299e1;
            box-shadow: 0 0 15px rgba(66, 153, 225, 0.2);
        }
        
        .scheme.recommended::before {
            content: "推荐";
            position: absolute;
            top: 10px;
            right: -30px;
            background: #4299e1;
            color: white;
            padding: 5px 35px;
            font-size: 0.85rem;
            font-weight: bold;
            transform: rotate(45deg);
        }
        
        .scheme h3 {
            font-size: 1.1rem;
            color: #2b6cb0;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #cbd5e0;
        }
        
        .scheme-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .scheme ul {
            list-style: none;
            margin: 0 0 15px 0;
            flex: 1;
        }
        
        .scheme li {
            padding: 6px 0;
            border-bottom: 1px solid #edf2f7;
            display: flex;
            font-size: 0.9rem;
        }
        
        .scheme li strong {
            min-width: 90px;
            display: inline-block;
            color: #4a5568;
            font-weight: 600;
        }
        
        .contact-section {
            background: #1a3a6c;
            color: white;
            padding: 30px;
            margin-top: 30px;
        }
        
        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .contact-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            transition: all 0.3s;
        }
        
        .contact-card:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }
        
        .contact-card h3 {
            color: #ffcc00;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .contact-info {
            margin-top: 10px;
            font-size: 0.95rem;
            line-height: 1.8;
        }
        
        .contact-info a {
            color: #a3bffa;
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .contact-info a:hover {
            color: white;
            text-decoration: underline;
        }
        
        .footer {
            padding: 20px;
            color: #4a5568;
            font-size: 0.9rem;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
        }
        
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }
        
        .visitor-counter {
            display: flex;
            align-items: center;
            background: white;
            padding: 8px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
        }
        
        .company-info {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }
        
        .company-info p {
            margin: 2px 0;
        }
        
        .hidden {
            display: none;
        }
        
        .scheme-benefits {
            margin-top: 18px;
        }
        
        .scheme-benefits h4 {
            color: #2b6cb0;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        
        .benefit-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 5px;
            font-size: 0.85rem;
        }
        
        .benefit-item i {
            color: #38a169;
            min-width: 16px;
            margin-top: 4px;
        }
        
        .material-options {
            position: static;
            margin: 18px 0 0 0;
        }
        
        .material-options h5 {
            color: #dd6b20;
            margin-bottom: 10px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .solution-advantage {
            background: linear-gradient(135deg, #2c5282, #1a3a6c);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            text-align: center;
        }
        
        .solution-advantage h3 {
            color: #ffcc00;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .solution-advantage p {
            margin-bottom: 10px;
            font-size: 1.05rem;
        }
        
        .height-match {
            color: #38a169;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .height-warning {
            color: #e53e3e;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
            max-width: 300px;
            z-index: 100;
            display: none;
        }
        
        .info-icon:hover + .tooltip {
            display: block;
        }
        
        .material-grid {
            display: grid;
            grid-template-columns: 1fr; /* 始终一列，无论屏幕宽度 */
            gap: 15px;
            margin-top: 10px;
        }
        
        .material-card {
            background: white;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .material-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid #f0f4f8;
        }
        
        .material-name {
            font-weight: bold;
            color: #2b6cb0;
            font-size: 0.95rem;
        }
        
        .material-hardness {
            font-size: 0.85rem;
            color: #718096;
            background: #f0f4f8;
            padding: 3px 8px;
            border-radius: 12px;
        }
        
        .material-desc {
            font-size: 0.85rem;
            color: #4a5568;
            margin-bottom: 12px;
            min-height: 40px;
        }
        
        .material-properties {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .property-item {
            display: flex;
            flex-direction: column;
        }
        
        .property-label {
            font-size: 0.8rem;
            color: #718096;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .property-value {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .grid-container {
            display: flex;
            gap: 3px;
        }
        
        .grid-box {
            width: 14px;
            height: 14px;
            border: 1px solid #cbd5e0;
            border-radius: 2px;
        }
        
        .grid-box.filled {
            background: #38a169;
            border-color: #38a169;
        }
        
        .rating-number {
            font-size: 0.85rem;
            font-weight: bold;
            min-width: 25px;
            text-align: right;
            color: #2b6cb0;
        }
        
        .property-notes {
            grid-column: span 2;
            font-size: 0.8rem;
            padding-top: 8px;
            border-top: 1px dashed #e2e8f0;
            margin-top: 5px;
        }
        
        .property-notes div {
            margin-bottom: 4px;
            display: flex;
            align-items: flex-start;
            gap: 5px;
        }
        
        .property-notes i {
            color: #38a169;
            margin-top: 3px;
        }
        
        .qr-section {
            margin-top: 40px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            text-align: center;
        }
        
        .qr-title {
            color: #ffcc00;
            font-size: 1.3rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .qr-codes {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .qr-item {
            flex: 1;
            min-width: 200px;
            max-width: 250px;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .qr-item:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .qr-img {
            width: 150px;
            height: 150px;
            display: block;
            margin: 0 auto 15px;
            border: 5px solid white;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        
        .qr-text {
            color: white;
            font-size: 0.95rem;
            font-weight: 500;
            margin-top: 10px;
        }
        
        .wheel-type-section {
            background: #edf2f7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #4299e1;
        }
        
        .wheel-type-section h4 {
            color: #2b6cb0;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .type-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            margin: 5px 0;
            border-radius: 6px;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .type-option:hover {
            background: rgba(66, 153, 225, 0.1);
        }
        
        .type-option.selected {
            background: rgba(66, 153, 225, 0.2);
            border: 1px solid #4299e1;
        }
        
        .type-option input[type="radio"] {
            display: none;
        }
        
        #caster-type-section {
            transition: all 0.3s ease-out;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }

        #caster-type-section[style*="display: block"] {
            opacity: 1;
            max-height: 500px;
        }
        
        .qr-placeholder {
            background: linear-gradient(45deg, #f0f0f0 25%, #e0e0e0 25%, #e0e0e0 50%, 
                #f0f0f0 50%, #f0f0f0 75%, #e0e0e0 75%, #e0e0e0 100%);
            background-size: 20px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        @media (max-width: 1200px) {
            .schemes-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .scheme:nth-child(3) {
                grid-column: span 2;
            }
            
            .material-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 900px) {
            .main-content {
                flex-direction: column;
            }
            
            .input-section {
                flex: 1;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
            }
            
            .schemes-container {
                grid-template-columns: 1fr;
            }
            
            .scheme:nth-child(3) {
                grid-column: span 1;
            }
            
            .qr-codes {
                flex-direction: column;
                align-items: center;
            }
        }
        
        @media (max-width: 600px) {
            .header-top {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .datetime-weather {
                text-align: left;
                width: 100%;
            }
            
            .action-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .action-btn {
                width: 100%;
                justify-content: center;
            }
            
            .container {
                border-radius: 10px;
            }
            
            .input-section, .result-section {
                padding: 20px;
            }
            
            .material-grid {
                grid-template-columns: 1fr !important; /* 强制一列 */
                gap: 10px;
            }
            
            .material-card {
                padding: 10px;
            }
            
            .material-name {
                font-size: 0.85rem;
            }
            
            .material-hardness {
                font-size: 0.75rem;
                padding: 2px 6px;
            }
            
            .material-desc {
                font-size: 0.8rem;
                min-height: 35px;
            }
            
            .property-label {
                font-size: 0.75rem;
            }
            
            .rating-number {
                font-size: 0.8rem;
                min-width: 20px;
            }
            
            .grid-box {
                width: 12px;
                height: 12px;
            }
        }
        .selected-bracket-img{box-shadow:0 0 0 2px #4299e1;border-radius:8px;background:#f0f6ff;}
        .selected-bracket-text{background:#e6f0ff;color:#1a3a6c !important;}        
        .schemes-container-watermark-bg {
            position: absolute;
            z-index: 2;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            user-select: none;
            overflow: hidden;
        }
        .schemes-container-watermark-bg::before {
            content: "";
            position: absolute;
            left: 50%;
            top: 50%;
            width: 200%; /* 更大，铺满整个推荐区域对角线 */
            height: 90%;
            transform: translate(-50%, -50%) rotate(-60deg);
            background: url('./logo-watermark.png') center center no-repeat;
            background-size: contain;
            opacity: 0.05;
            pointer-events: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <!-- 斜向水印logo，覆盖页面但不影响观感 -->
    <div style="pointer-events:none;user-select:none;position:fixed;z-index:0;top:0;left:0;width:100vw;height:100vh;overflow:hidden;">
      <img src="./logo-watermark.png" alt="JIANGLONG LOGO 水印" style="
        position:absolute;
        top:10vh;
        left:-10vw;
        width:80vw;
        max-width:900px;
        opacity:0.05;
        transform:rotate(-65deg);
        filter: grayscale(30%);
        ">
    </div>
    <div class="container" id="full-container">
        <header>
            <div class="header-top">
                <div class="logo">
                        <img src="./company-logo.png" alt="江龙脚轮" style="width:100px;height:100px;">
                    <div class="logo-text">
                        <h1>江龙脚轮选型系统</h1>
                        <p>FABE话术生成器 - 专业脚轮解决方案</p>
                    </div>
                </div>
                <div class="datetime-weather">
                    <div id="current-date">2025年7月11日 星期五</div>
                    <div id="weather">阳江天气: 晴 24℃</div>
                </div>
            </div>
        </header>
        
        <div class="solution-advantage">
            <h3><i class="fas fa-star"></i> 江龙脚轮解决方案核心优势</h3>
            <p>载重能力提升30% | 使用寿命延长50% | 滚动阻力降低20%</p>
            <p>提供全系产品3D模型下载 | 数字孪生定制服务 | 可视化决策支持</p>
        </div>
        
        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title"><i class="fas fa-calculator"></i> 参数输入</h2>
                
                <div class="form-group">
                    <label for="frame-weight">车架自重 (kg)</label>
                    <input type="number" id="frame-weight" placeholder="请输入车架重量" value="50">
                </div>
                
                <div class="form-group">
                    <label for="cargo-weight">货物总重量 (kg)</label>
                    <input type="number" id="cargo-weight" placeholder="请输入货物总重量" value="800">
                </div>
                
                <div class="form-group">
                    <label for="safety-factor">安全系数</label>
                    <input type="number" id="safety-factor" value="1.3" step="0.1" min="1.0">
                </div>
                
                <div class="form-group">
                    <label for="wheel-count">所需脚轮数量</label>
                    <input type="number" id="wheel-count" placeholder="请输入脚轮数量" value="4">
                </div>

                
                <div class="formula-box">
                    <h3><i class="fas fa-ruler-combined"></i> 脚轮载重计算公式</h3>
                    <p>单只脚轮载重要求 = (车架自重 + 货物总重量) × 安全系数 ÷ 所需脚轮数量</p>
                    <p id="formula-calculation">计算结果将显示在这里</p>
                </div>
                
                <div class="form-group">
                    <label for="height-req">高度要求 (mm)</label>
                    <input type="number" id="height-req" placeholder="请输入高度要求" value="140">
                    <i class="fas fa-info-circle info-icon"></i>
                    <div class="tooltip">脚轮总高度 = 轮子直径 × 1.4 (标准比例)<br>系统将根据您输入的高度推荐最合适的轮子尺寸</div>
                </div>
                

                
                <div class="form-group">
                    <label for="environment">使用环境</label>
                    <select id="environment">
                        <option value="">请选择使用环境</option>
                        <option value="indoor" selected="">室内平坦地面 (-20℃~60℃)</option>
                        <option value="outdoor">室外粗糙地面 (-20℃~80℃)</option>
                        <option value="high-temp">高温环境 (60℃~120℃)</option>
                        <option value="low-temp">低温环境 (-40℃~0℃)</option>
                        <option value="cleanroom">无尘车间 (-20℃~60℃)</option>
                        <option value="food">食品加工环境 (-20℃~80℃)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="application-scenario">应用场景</label>
                    <select id="application-scenario">
                        <option value="general">常规工业搬运</option>
                        <option value="medical">医疗设备（静音要求高）</option>
                        <option value="outdoor">室外搬运（耐久性要求高）</option>
                        <option value="food">食品加工（卫生要求高）</option>
                        <option value="heavy">重载设备（承载要求高）</option>
                        <option value="cleanroom">无尘车间（防静电要求）</option>
                    </select>
                </div>




                
                <button class="calculate-btn" id="calculate-btn">
                    <i class="fas fa-calculator"></i> 计算并推荐方案
                </button>
                <div class="result-details" id="result-details" style="margin-top:18px;">
                    <h4>方案说明：</h4>
                    <p>1. <strong>标准方案</strong>：满足基本载重需求，性价比高，适用于常规使用场景</p>
                    <p>2. <strong>增强方案</strong>：提供10%额外安全裕度，适用于频繁使用或中等强度场景</p>
                    <p>3. <strong>高强方案</strong>：提供25%额外安全裕度，适用于高强度、高频率或关键应用场景</p>
                </div>
            </div>
            
            <div class="result-section">
                <h2 class="section-title"><i class="fas fa-clipboard-list"></i> 推荐方案</h2>
                
                <div class="result-container">
                    <div class="result-header">
                        <h3 id="result-title">请先输入参数并点击计算按钮</h3>
                        <div class="action-buttons">
                            <button class="action-btn generate-btn" id="generate-btn">
                                <i class="fas fa-camera"></i> 生成方案图片
                            </button>
                            <button class="action-btn copy-btn" id="copy-btn">
                                <i class="fas fa-copy"></i> 复制推荐话术
                            </button>
                        </div>
                    </div>
                    
                    <div class="schemes-container" id="schemes-container">
                        <!-- 方案会通过JS动态生成 -->
                    </div>
                </div>
            </div>
        </div>
        
        <div class="contact-section">
            <h2 class="section-title" style="color: #ffcc00; border-color: #ffcc00;"><i class="fas fa-address-card"></i> 联系我们</h2>
            
            <div class="contact-grid">
                <div class="contact-card">
                    <h3><i class="fas fa-building"></i> 公司信息</h3>
                    <div class="contact-info">
                        <p>阳江市江龙精密脚轮有限公司</p>
                        <p>JIANGLONG PRECISION CASTER Co.,LTD.</p>
                        <p>地址: 广东省阳江市沿江南路第二工业开发区(江闸公路边)</p>
                        <p>ADD.: YANJIANG SOUTH RD.INDUSTRIAL ZONE YANGJIANG GUANGDONG CHINA</p>
                    </div>
                </div>
                
                <div class="contact-card">
                    <h3><i class="fas fa-phone-alt"></i> 联系方式</h3>
                    <div class="contact-info">
                        <p>联系我们：</p>
                        <p>手机（Mob）86-013018510222（梁小姐，Anna）</p>
                        <p>电话(TEL): 86-662-2829599 / 3505491</p>
                        <p>传真(FAX): 86-662-3506528</p>
                        <p>邮箱(E.MAIL): <a href="mailto:jlcaster@vip.126.com">jlcaster@vip.126.com</a></p>
                    </div>
                </div>
                
                <div class="contact-card">
                    <h3><i class="fas fa-globe"></i> 网站资源</h3>
                    <div class="contact-info">
                        <p>官网: <a href="https://www.jianglongcaster.com" target="_blank">www.jianglongcaster.com</a></p>
                        <p>WEB 3D交互平台: <a href="https://www.casterpartner.com" target="_blank">www.casterpartner.com</a></p>
                        <p class="highlight">江龙精密脚轮开放全系产品STEP/IGES三维模型下载，提供非标脚轮数字孪生服务，诚邀客商对接江龙全新WEB 3D交互模块，实现可视化决策闭环，加速订单成交。</p>
                        <p>Jianglong Precision Casters now offers open downloads of STEP/IGES 3D models for its full product line and provides digital twin services for custom caster solutions. We invite partners to explore Jianglong's all-new WEB 3D interactive module, enabling visual decision-making loops to accelerate order conversion.</p>
                    </div>
                </div>
            </div>
            
            <!-- 二维码区域 -->
            <div class="qr-section">
                <h3 class="qr-title"><i class="fas fa-qrcode"></i> 扫码了解更多江龙脚轮产品信息</h3>
                <div class="qr-codes">
                    <!-- 产品分享页二维码 -->
                    <div class="qr-item">
                        <img src="data:image/png;base64,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" alt="江龙脚轮产品分享页" class="qr-img" onerror="handleImageError(this, 'images/product-fallback.png')">
                        <div class="qr-text">江龙脚轮产品分享页</div>
                    </div>

                    <!-- 官方网站二维码 -->
                    <div class="qr-item">
                        <img src="https://11112263.s21i.faimallusr.com/4/ABUIABAEGAAgq7G8wwYorraI5gMwyAM4zAM.png" alt="江龙精密脚轮官网" class="qr-img" onerror="handleImageError(this, 'images/website-fallback.png')">
                        <div class="qr-text">江龙精密脚轮官网</div>
                    </div>

                    <!-- 3D交互平台二维码 -->
                    <div class="qr-item">
                        <img src="https://11112263.s21i.faimallusr.com/4/ABUIABAEGAAgq7G8wwYo_tWz9AIwyAM4vgM.png" alt="WEB 3D交互平台" class="qr-img" onerror="handleImageError(this, 'images/3d-fallback.png')">
                        <div class="qr-text">WEB 3D交互平台</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <div class="footer-content">
                <div class="visitor-counter visitorCounterWrap" id="visitor-counter" style="display:flex;gap:8px;align-items:center;">
                        <span style="color:#2b6cb0;font-weight:600;white-space:nowrap;">访问量</span>
                        <!-- 新增：统计数字显示容器，ID必须是visitor-counter-pos -->
                        <div class='visitorCounterPosition' id="visitor-counter-pos" style="min-width:72px;text-align:left;color:#2b6cb0;font-weight:700;"></div>
                    </div>
                <div class="company-info" style="display:flex;flex-direction:column;gap:2px;">
                    <p>© 2025 阳江市江龙精密脚轮有限公司 | 专业脚轮解决方案提供商</p>
                    <p>ISO 9001:2015 质量认证企业 | 100+项技术专利 | 服务全球3000+客户</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 更新日期和天气
        async function updateDateTime() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                weekday: 'long' 
            };
            document.getElementById('current-date').textContent = now.toLocaleDateString('zh-CN', options);

            // 调用天气API获取实时天气
            try {
                const response = await fetch('https://www.weatherapi.com/docs/v1/current.json');
                if (response.ok) {
                    const weatherData = await response.json();
                    const weatherDescription = weatherData.weather[0].description;
                    const temperature = weatherData.main.temp;
                    document.getElementById('weather').textContent = `阳江天气: ${weatherDescription} ${temperature}℃`;
                } else {
                    console.error('天气API请求失败', response.status);
                }
            } catch (error) {
                console.error('天气API请求错误', error);
            }
        }

        // 默认显示脚轮类型选择区域，修复 section 可能为 null 的问题
        document.addEventListener('DOMContentLoaded', function() {
            const section = document.getElementById('caster-type-section');
            if (section) {
                section.style.display = 'block';
                section.style.opacity = '1';
                section.style.maxHeight = '500px';
            }
        });

        // 脚轮尺寸数据（包含高度信息）
        const wheelSizes = [
            { diameter: 25, loadRange: [15, 80], height: 35 },
            { diameter: 30, loadRange: [20, 100], height: 40 },
            { diameter: 35, loadRange: [25, 120], height: 50 },
            { diameter: 40, loadRange: [30, 150], height: 60 },
            { diameter: 45, loadRange: [35, 180], height: 65 },
            { diameter: 50, loadRange: [40, 135], height: 70 },
            { diameter: 65, loadRange: [45, 135], height: 91 },
            { diameter: 75, loadRange: [50, 220], height: 105 },
            { diameter: 88, loadRange: [55, 135], height: 123 },
            { diameter: 100, loadRange: [60, 1000], height: 140 },
            { diameter: 125, loadRange: [70, 1100], height: 175 },
            { diameter: 150, loadRange: [80, 2300], height: 210 },
            { diameter: 200, loadRange: [150, 3300], height: 280 },
            { diameter: 250, loadRange: [180, 4500], height: 350 },
            { diameter: 300, loadRange: [200, 5500], height: 420 },
            { diameter: 350, loadRange: [220, 6500], height: 480 },
            { diameter: 400, loadRange: [250, 7500], height: 560 },
            { diameter: 500, loadRange: [300, 9000], height: 700 }
        ];
        // 允许的轮径数组，供推荐方案判断用
        const allowedDiameters = wheelSizes.map(ws => ws.diameter);
        
        // 支架系列数据（包含图片URL）
        const bracketSeries = [
            { series: "K91", loadRange: [10000, Infinity], desc: "超重型工业脚轮支架", imageUrl: "./K91.jpg" },
            { series: "K90", loadRange: [3000, 10000], desc: "超重型工业脚轮支架", imageUrl: "./K90.jpg" },
            { series: "R90", loadRange: [3000, 10000], desc: "超重型工业脚轮支架", imageUrl: "./R90.jpg" },
            { series: "K88", loadRange: [2000, 5000], desc: "超重型工业脚轮支架", imageUrl: "./K88.jpg" },
            { series: "R88", loadRange: [2000, 5000], desc: "超重型工业脚轮支架", imageUrl: "./R88.jpg" },
            { series: "K80", loadRange: [1000, 3300], desc: "超重型工业脚轮支架", imageUrl: "./K80.jpg" },
            { series: "R80", loadRange: [1000, 3300], desc: "超重型工业脚轮支架", imageUrl: "./R80.jpg" },
            { series: "81", loadRange: [600, 1800], desc: "超重型工业脚轮支架", imageUrl: "./81.jpg" },
            { series: "80", loadRange: [600, 1800], desc: "超重型工业脚轮支架", imageUrl: "./80.jpg" },
            { series: "69", loadRange: [450, 800], desc: "重型工业脚轮支架", imageUrl: "./69.jpg" },
            { series: "68", loadRange: [450, 800], desc: "重型工业脚轮支架", imageUrl: "./68.jpg" },
            { series: "K63", loadRange: [100, 550], desc: "重型工业脚轮支架", imageUrl: "./K63.jpg" },
            { series: "R63", loadRange: [100, 550], desc: "重型工业脚轮支架", imageUrl: "./R63.jpg" },
            { series: "N63", loadRange: [100, 550], desc: "重型工业脚轮支架", imageUrl: "./N63.jpg" },
            { series: "51", loadRange: [25, 135], desc: "重型工业脚轮支架", imageUrl: "./51.jpg" },
            { series: "56", loadRange: [25, 135], desc: "中重型商用脚轮支架", imageUrl: "./56.jpg" },
            { series: "46", loadRange: [25, 135], desc: "中重型商用脚轮支架", imageUrl: "./46.jpg" },
            { series: "42", loadRange: [25, 135], desc: "中重型商用脚轮支架", imageUrl: "./42.jpg" },
            { series: "33", loadRange: [25, 135], desc: "中重型商用脚轮支架", imageUrl: "./33.jpg" },
            { series: "30", loadRange: [25, 135], desc: "中重型商用脚轮支架", imageUrl: "./30.jpg" },
            { series: "N63", loadRange: [100, 550], desc: "重型工业脚轮支架", imageUrl: "./N63.jpg" },
            { series: "K63", loadRange: [100, 550], desc: "重型工业脚轮支架", imageUrl: "./K63.jpg" },
            { series: "63", loadRange: [100, 550], desc: "重型工业脚轮支架", imageUrl: "./63.jpg" }
        ];
        
        // 材质数据（包含详细的属性信息）
        const materials = [
            { 
                name: "充气轮", 
                hardness: "75 ShoreA", 
                maxLoad: 350, 
                rollingResistance: 2, 
                wearResistance: 2, 
                floorProtection: 5, 
                noise: 3,
                desc: "适用于轻载、减震需求场合，地板保护好",
                advantages: "减震性能优异，地板保护好",
                disadvantages: "需定期检查胎压；需避开尖锐物",
                scenarioPriority: {
                    general: 2,
                    medical: 3,
                    outdoor: 4,
                    food: 1,
                    heavy: 1,
                    cleanroom: 2
                },
                tempRange: [-20, 55]
            },
            { 
                name: "实心橡胶", 
                hardness: "85-95 ShoreA", 
                maxLoad: 2000, 
                rollingResistance: 2, 
                wearResistance: 3, 
                floorProtection: 4, 
                noise: 2,
                desc: "减震性好，适用于不平地面",
                advantages: "减震性好，噪音低",
                disadvantages: "需承受高滚动阻力；需防老化开裂",
                scenarioPriority: {
                    general: 4,
                    medical: 5,
                    outdoor: 4,
                    food: 1,
                    heavy: 3,
                    cleanroom: 4
                },
                tempRange: [-20, 75]
            },
            { 
                name: "软橡胶", 
                hardness: "75-85 ShoreA", 
                maxLoad: 500, 
                rollingResistance: 2, 
                wearResistance: 2, 
                floorProtection: 4, 
                noise: 3,
                desc: "适用于轻载、静音需求场合",
                advantages: "静音，地板保护好",
                disadvantages: "限轻载使用；需避开高温、粗糙地面",
                scenarioPriority: {
                    general: 3,
                    medical: 5,
                    outdoor: 2,
                    food: 2,
                    heavy: 1,
                    cleanroom: 3
                },
                tempRange: [-20, 90]
            },
            { 
                name: "人造橡胶TPR", 
                hardness: "75-85 ShoreA", 
                maxLoad: 500, 
                rollingResistance: 4, 
                wearResistance: 2, 
                floorProtection: 4, 
                noise: 3,
                desc: "经济实用，适用于室内平坦地面",
                advantages: "价格实惠，静音效果好",
                disadvantages: "需避开油污溶剂；需防高温软化",
                scenarioPriority: {
                    general: 3,
                    medical: 5,
                    outdoor: 1,
                    food: 2,
                    heavy: 1,
                    cleanroom: 3
                },
                tempRange: [-20, 55]
            },
            { 
                name: "塑芯PU", 
                hardness: "95 ShoreA", 
                maxLoad: 500, 
                rollingResistance: 4, 
                wearResistance: 3, 
                floorProtection: 4, 
                noise: 3,
                desc: "耐磨性好，适用于多种地面",
                advantages: "耐磨性强，适合中等载重",
                disadvantages: "需避开高温、尖锐物；不适用于安静敏感区",
                scenarioPriority: {
                    general: 4,
                    medical: 4,
                    outdoor: 4,
                    food: 3,
                    heavy: 2,
                    cleanroom: 3
                },
                tempRange: [-20, 75]
            },
            { 
                name: "浇注PU", 
                hardness: "95 ShoreA", 
                maxLoad: 5000, 
                rollingResistance: 4, 
                wearResistance: 4, 
                floorProtection: 4, 
                noise: 4,
                desc: "高承载，耐磨，适用于工业环境",
                advantages: "高载重能力，耐磨性极佳",
                disadvantages: "需避开高温、尖锐物；不适用于安静敏感区",
                scenarioPriority: {
                    general: 5,
                    medical: 2,
                    outdoor: 5,
                    food: 4,
                    heavy: 5,
                    cleanroom: 2
                },
                tempRange: [-20, 75]
            },
            { 
                name: "浇注软PU", 
                hardness: "75 ShoreA", 
                maxLoad: 300, 
                rollingResistance: 3, 
                wearResistance: 4, 
                floorProtection: 5, 
                noise: 3,
                desc: "适用于洗地机等设备，柔软静音",
                advantages: "静音，地板保护好",
                disadvantages: "限轻载使用；需防高温变形",
                scenarioPriority: {
                    general: 2,
                    medical: 4,
                    outdoor: 2,
                    food: 2,
                    heavy: 1,
                    cleanroom: 3
                },
                tempRange: [-20, 75]
            },
            { 
                name: "PP聚丙烯", 
                hardness: "70 ShoreD", 
                maxLoad: 2000, 
                rollingResistance: 5, 
                wearResistance: 2, 
                floorProtection: 2, 
                noise: 3,
                desc: "经济型材质，适用于一般环境",
                advantages: "价格低，耐腐蚀",
                disadvantages: "需避开低温；限轻载使用",
                scenarioPriority: {
                    general: 2,
                    medical: 2,
                    outdoor: 2,
                    food: 2,
                    heavy: 1,
                    cleanroom: 2
                },
                tempRange: [-20, 65]
            },
            { 
                name: "酚醛", 
                hardness: "70 ShoreD", 
                maxLoad: 2000, 
                rollingResistance: 5, 
                wearResistance: 4, 
                floorProtection: 2, 
                noise: 4,
                desc: "高温耐磨，适用于高温环境和重载设备",
                advantages: "耐高温，耐磨性好",
                disadvantages: "配合垫板使用（保护地板）；需严防冲击",
                scenarioPriority: {
                    general: 3,
                    medical: 1,
                    outdoor: 3,
                    food: 2,
                    heavy: 4,
                    cleanroom: 2
                },
                tempRange: [-20, 280]
            },
            { 
                name: "尼龙", 
                hardness: "70 ShoreD", 
                maxLoad: 2000, 
                rollingResistance: 5, 
                wearResistance: 4, 
                floorProtection: 3, 
                noise: 4,
                desc: "高强度，适用于重载环境",
                advantages: "高载重能力，耐磨性强",
                disadvantages: "配合垫板使用（保护地板）；需防潮储存",
                scenarioPriority: {
                    general: 4,
                    medical: 1,
                    outdoor: 5,
                    food: 2,
                    heavy: 5,
                    cleanroom: 3
                },
                tempRange: [-20, 90]
            },
            { 
                name: "浇注尼龙", 
                hardness: "70 ShoreD", 
                maxLoad: 15000, 
                rollingResistance: 5, 
                wearResistance: 4, 
                floorProtection: 3, 
                noise: 4,
                desc: "超高强度，适用于重载环境",
                advantages: "极高载重能力，耐磨性强",
                disadvantages: "需防潮储存/使用；需避开低温",
                scenarioPriority: {
                    general: 4,
                    medical: 1,
                    outdoor: 5,
                    food: 2,
                    heavy: 5,
                    cleanroom: 3
                },
                tempRange: [-20, 65]
            },
            { 
                name: "灰铸铁", 
                hardness: "HB250", 
                maxLoad: 5000, 
                rollingResistance: 5, 
                wearResistance: 5, 
                floorProtection: 1, 
                noise: 5,
                desc: "极端重载，适用于特殊工业环境",
                advantages: "极高载重能力，耐磨性极佳",
                disadvantages: "配合垫板使用（保护地板）；需防锈处理；",
                scenarioPriority: {
                    general: 3,
                    medical: 1,
                    outdoor: 5,
                    food: 1,
                    heavy: 5,
                    cleanroom: 1
                },
                tempRange: [-60, 550]
            },
            { 
                name: "球墨铸铁", 
                hardness: "H8400", 
                maxLoad: 15000, 
                rollingResistance: 5, 
                wearResistance: 5, 
                floorProtection: 1, 
                noise: 5,
                desc: "极端重载，适用于特殊工业环境",
                advantages: "极高载重能力，耐磨性极佳",
                disadvantages: "配合垫板使用（保护地板）；需防锈处理",
                scenarioPriority: {
                    general: 3,
                    medical: 1,
                    outdoor: 5,
                    food: 1,
                    heavy: 5,
                    cleanroom: 1
                },
                tempRange: [-60, 550]
            },
            { 
                name: "45号钢", 
                hardness: "H8400", 
                maxLoad: 15000, 
                rollingResistance: 5, 
                wearResistance: 5, 
                floorProtection: 1, 
                noise: 5,
                desc: "极端重载，适用于特殊工业环境",
                advantages: "极高载重能力，耐磨性极佳",
                disadvantages: "配合垫板使用（保护地板）；需严格防锈处理",
                scenarioPriority: {
                    general: 3,
                    medical: 1,
                    outdoor: 5,
                    food: 1,
                    heavy: 5,
                    cleanroom: 1
                },
                tempRange: [-60, 550]
            }
            // 下面为图片未列出但原有的材质，保留原温度区间
        ];
        
        // 环境与温度区间映射
        const environmentTempMap = {
            "indoor": [-20, 60],
            "outdoor": [-20, 80],
            "high-temp": [60, 120],
            "low-temp": [-40, 0],
            "cleanroom": [-20, 60],
            "food": [-20, 80]
        }
        
        // 根据应用场景获取场景描述
        function getScenarioDescription(scenario) {
            const descriptions = {
                general: "常规工业搬运",
                medical: "医疗设备（静音要求高）",
                outdoor: "室外搬运（耐久性要求高）",
                food: "食品加工（卫生要求高）",
                heavy: "重载设备（承载要求高）",
                cleanroom: "无尘车间（防静电要求）"
            };
            return descriptions[scenario] || "常规工业搬运";
        }
        
        // 获取单轮类型描述
        function getWheelTypeDescription(type) {
            return wheelTypes[type] || wheelTypes.centric;
        }
        
        // 计算按钮事件
        document.getElementById('calculate-btn').addEventListener('click', function() {
            const frameWeight = parseFloat(document.getElementById('frame-weight').value) || 0;
            const cargoWeight = parseFloat(document.getElementById('cargo-weight').value) || 0;
            const safetyFactor = parseFloat(document.getElementById('safety-factor').value) || 1.3;
            const wheelCount = parseFloat(document.getElementById('wheel-count').value) || 4;
            const heightReq = parseFloat(document.getElementById('height-req').value);
            const applicationScenario = document.getElementById('application-scenario').value;
            const environment = document.getElementById('environment').value;

            
            if (wheelCount <= 0) {
                alert('请输入有效的脚轮数量');
                return;
            }
            
            // 计算单只脚轮载重要求
            const loadPerWheel = (frameWeight + cargoWeight) * safetyFactor / wheelCount;
            
            // 更新公式显示
            const formulaText = `计算结果: (${frameWeight} + ${cargoWeight}) × ${safetyFactor} ÷ ${wheelCount} = ${loadPerWheel.toFixed(2)} kg`;
            document.getElementById('formula-calculation').textContent = formulaText;
            
            // 更新结果标题
            let resultTitle = `单只脚轮载重要求: ${loadPerWheel.toFixed(2)} kg`;
            if (heightReq) {
                resultTitle += ` | 高度要求: ${heightReq} mm`;
            }
            resultTitle += `<br>应用场景: ${getScenarioDescription(applicationScenario)}`;

            document.getElementById('result-title').innerHTML = resultTitle;
            
            // 生成推荐方案
            generateRecommendations(loadPerWheel, heightReq, applicationScenario, environment);
        });
        
        // 计算轮子高度区间
        function getWheelHeightRange(diameter) {
            return `${Math.round(diameter * 1.4)} mm`;
        }
        
        // 根据支架系列和载重推荐轮子（可指定最小直径约束）
        function findBestWheelForBracketAndLoad(bracketSeries, load, minDiameter = 0) {
            const diameters = bracketWheelDiameters[bracketSeries] || [];
            // 只选大于等于minDiameter的直径，并升序排列
            const validDiameters = diameters.filter(d => d >= minDiameter).sort((a, b) => a - b);
            if (validDiameters.length === 0) return null;
            // 找到该支架轮径区间内所有能承载该负载的轮子
            const candidateWheels = validDiameters.map(d => wheelSizes.find(w => w.diameter === d && load >= w.loadRange[0] && load <= w.loadRange[1])).filter(Boolean);
            if (candidateWheels.length === 0) {
                // 没有完全匹配，返回区间内最小轮径轮子
                const d = validDiameters[0];
                return wheelSizes.find(w => w.diameter === d);
            }
            // 计算该支架允许的最大/最小载重
            const minLoad = Math.min(...candidateWheels.map(w => w.loadRange[0]));
            const maxLoad = Math.max(...candidateWheels.map(w => w.loadRange[1]));
            // 计算负载在区间的占比
            let percent = 0.5;
            if (maxLoad > minLoad) {
                percent = (load - minLoad) / (maxLoad - minLoad);
                percent = Math.max(0, Math.min(1, percent));
            }
            // 根据占比选择靠近最大/最小/中间的轮径
            let idx = 0;
            if (percent <= 0.33) {
                idx = 0; // 靠近下限，选最小轮径
            } else if (percent >= 0.66) {
                idx = candidateWheels.length - 1; // 靠近上限，选最大轮径
            } else {
                idx = Math.floor(candidateWheels.length / 2); // 居中，选中间轮径
            }
            return candidateWheels[idx];
        }
        
        // 生成五格图
        function generateGrid(value) {
            let gridHTML = '';
            for (let i = 1; i <= 5; i++) {
                gridHTML += `<div class="grid-box ${i <= value ? 'filled' : ''}"></div>`;
            }
            return gridHTML;
        }
        
        // 生成材质卡片HTML
        function generateMaterialCard(material) {
            // 处理缺点分行显示
            let disadvantagesArr = [];
            if (typeof material.disadvantages === 'string') {
                disadvantagesArr = material.disadvantages.split(/[，,；;。\n]/).map(s => s.trim()).filter(Boolean);
            } else if (Array.isArray(material.disadvantages)) {
                disadvantagesArr = material.disadvantages;
            }

            // 生成温度范围显示
            const tempRangeHTML = material.tempRange ? `
                <div class="temp-range" style="background: #e6fffa; padding: 5px 10px; border-radius: 5px; display: inline-block;">
                    <i class="fas fa-temperature-low" style="color: #38a169;"></i> ${material.tempRange[0]}°C ~ ${material.tempRange[1]}°C
                </div>
            ` : '';

            return `
                <div class="material-card">
                    <div class="material-header">
                        <div class="material-name">${material.name}</div>
                        <div class="material-hardness">${material.hardness}</div>
                    </div>
                    <div class="material-desc">
                        ${material.desc}
                        ${tempRangeHTML}
                    </div>
                    <div class="material-properties">
                        <div class="property-item">
                            <div class="property-label">
                                <i class="fas fa-truck-loading"></i> 滚动阻力
                            </div>
                            <div class="property-value">
                                <div class="grid-container">${generateGrid(material.rollingResistance)}</div>
                                <div class="rating-number">${material.rollingResistance}/5</div>
                            </div>
                        </div>
                        <div class="property-item">
                            <div class="property-label">
                                <i class="fas fa-shield-alt"></i> 耐磨性
                            </div>
                            <div class="property-value">
                                <div class="grid-container">${generateGrid(material.wearResistance)}</div>
                                <div class="rating-number">${material.wearResistance}/5</div>
                            </div>
                        </div>
                        <div class="property-item">
                            <div class="property-label">
                                <i class="fas fa-home"></i> 地板保护
                            </div>
                            <div class="property-value">
                                <div class="grid-container">${generateGrid(material.floorProtection)}</div>
                                <div class="rating-number">${material.floorProtection}/5</div>
                            </div>
                        </div>
                        <div class="property-item">
                            <div class="property-label">
                                <i class="fas fa-volume-up"></i> 操作噪音
                            </div>
                            <div class="property-value">
                                <div class="grid-container">${generateGrid(material.noise)}</div>
                                <div class="rating-number">${material.noise}/5</div>
                            </div>
                        </div>
                        
                        <div class="property-notes">
                            <div>
                                <i class="fas fa-check-circle"></i>
                                <span><strong>优势</strong>: ${material.advantages}</span>
                            </div>
                            <div>
                                <i class="fas fa-exclamation-circle"></i>
                                <span style="white-space:normal; word-break:keep-all;"><strong>不足</strong>: ${(() => {
                                    let text = typeof material.disadvantages === 'string' ? material.disadvantages.replace(/\s*([；;])\s*/g, '$1') : (Array.isArray(material.disadvantages) ? material.disadvantages.join('；').replace(/\s*([；;])\s*/g, '$1') : '');
                                    // 合并"理；"等孤立结尾，并用不换行空格防止断行
                                    text = text.replace(/；/g, '；\u00A0');
                                    const lines = text.split(/\n|<br\s*\/?\s*>/);
                                    if (lines.length > 1 && lines[1].length <= 2) {
                                        return lines[0] + lines[1];
                                    }
                                    return text;
                                })()}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // 根据应用场景和环境筛选材质
        function filterMaterialsByScenario(applicationScenario, load, environment) {
            // 首先筛选满足载重要求的材质
            let suitableMaterials = materials.filter(m => m.maxLoad >= load);
            // 筛选温度
            if (environment) {
                const [envMin, envMax] = environmentTempMap[environment] || [-100, 200];
                suitableMaterials = suitableMaterials.filter(m => {
                    if (!m.tempRange) return true; // 没有温度限制的材质默认通过
                    const [matMin, matMax] = m.tempRange;
                    // 材质温度区间要覆盖环境区间
                    return matMin <= envMin && matMax >= envMax;
                });
            }
            
            // 15000kg以上优先推荐浇注尼龙
            if (load >= 15000) {
                suitableMaterials.sort((a, b) => {
                    // 浇注尼龙优先
                    if (a.name === "浇注尼龙" && b.name !== "浇注尼龙") return -1;
                    if (b.name === "浇注尼龙" && a.name !== "浇注尼龙") return 1;
                    
                    // 其他材质按载重能力排序
                    return b.maxLoad - a.maxLoad;
                });
            } else {
                // 根据应用场景进行排序
                suitableMaterials.sort((a, b) => {
                    // 获取当前场景下的优先级
                    const priorityA = a.scenarioPriority[applicationScenario] || 1;
                    const priorityB = b.scenarioPriority[applicationScenario] || 1;
                    
                    // 优先级高的排在前面
                    return priorityB - priorityA;
                });
            }
            
            return suitableMaterials;
        }
        
        // 获取应用场景的优化建议
        function getScenarioOptimization(scenario) {
            const optimizations = {
                medical: {
                    title: "医疗环境优化建议",
                    tips: [
                        "优先选择静音材质，减少设备噪音",
                        "选择平滑轮面设计，减少震动",
                        "考虑防静电材质，避免干扰医疗设备"
                    ]
                },
                outdoor: {
                    title: "室外搬运优化建议",
                    tips: [
                        "选择耐磨性高的材质，延长使用寿命",
                        "考虑防水防锈设计",
                        "选择大尺寸轮子，适应不平地面"
                    ]
                },
                food: {
                    title: "食品加工优化建议",
                    tips: [
                        "使用符合FDA标准的食品级材质",
                        "选择易清洁、防油污的轮面",
                        "考虑不锈钢支架，防腐蚀"
                    ]
                },
                heavy: {
                    title: "重载设备优化建议",
                    tips: [
                        "选择高承载能力的材质",
                        "使用重型支架系列",
                        "考虑双轮或加强轮设计"
                    ]
                },
                cleanroom: {
                    title: "无尘车间优化建议",
                    tips: [
                        "选择防静电材质",
                        "避免使用易产生微粒的材质",
                        "考虑密封轴承，减少灰尘进入"
                    ]
                },
                general: {
                    title: "常规工业优化建议",
                    tips: [
                        "平衡性能与成本",
                        "选择通用型材质，适应多种场景",
                        "考虑中等耐磨性和滚动阻力"
                    ]
                }
            };
            
            return optimizations[scenario] || optimizations.general;
        }
        
        // 支架区间推荐表
        const bracketRangeRecommend = [
            { min: 10000, max: Infinity, series: ["K91"] },
            { min: 3000, max: 10000, series: ["K90", "R90"] },
            { min: 2000, max: 5000, series: ["K88", "R88"] },
            { min: 1000, max: 3300, series: ["K80", "R80"] },
            { min: 600, max: 1800, series: ["80", "81"] },
            { min: 450, max: 800, series: ["68", "69"] },
            { min: 100, max: 449, series: ["N63", "K63", "63", "51", "R63"] },
            { min: 25, max: 135, series: ["30", "33", "42", "46", "56"] }
        ];
        
        function getBracketSeriesByLoad(load, schemeType = 'standard') {
            // 135公斤以下特殊逻辑
            if (load <= 135) {
                if (schemeType === 'standard') {
                    return ["30", "33"];
                } else if (schemeType === 'enhanced') {
                    return ["46", "42"];
                } else if (schemeType === 'strong') {
                    return ["56"];
                }
            }
            // 100-449公斤区间推荐逻辑
            if (load > 99 && load < 450) {
                // 51系列仅推荐300kg及以下
                let result = [];
                if (load <= 300) result.push("N63", "K63","51", "63", "R63");
                // 优先推荐N63、K63
                result.push("N63", "K63", "63", "R63");
                return result;
            }
            // 其它区间优先K开头（子母），其次N开头（新款），不推荐R开头
            // bracketSeries已包含所有系列
            // 先筛选K开头
            let candidates = bracketSeries.filter(b => b.series.startsWith('K') && load >= b.loadRange[0] && load <= b.loadRange[1]);
            if (candidates.length > 0) return candidates.map(b => b.series);
            // 再筛选N开头
            candidates = bracketSeries.filter(b => b.series.startsWith('N') && load >= b.loadRange[0] && load <= b.loadRange[1]);
            if (candidates.length > 0) return candidates.map(b => b.series);
            // 其它非R开头
            candidates = bracketSeries.filter(b => !b.series.startsWith('R') && load >= b.loadRange[0] && load <= b.loadRange[1]);
            if (candidates.length > 0) return candidates.map(b => b.series);
            // 最后兜底
            candidates = bracketSeries.filter(b => load >= b.loadRange[0] && load <= b.loadRange[1]);
            if (candidates.length > 0) return candidates.map(b => b.series);
            return [];
        }
        
        // 支架系列对应推荐轮子直径
        const bracketWheelDiameters = {
            '30': [25, 35, 40, 50],
            '33': [25, 35, 40, 50, 65, 75],
            '42': [75, 88, 100, 125, 150],
            '46': [75, 88, 100, 125, 150],
            '56': [75, 88, 100, 125, 150],
            '51': [75, 100, 125, 150, 200, 250],
            '63': [75, 100, 125, 150, 200, 250],
            'K63': [75, 100, 125, 150, 200, 250],
            'N63': [75, 100, 125, 150, 200, 250],
            'R63': [75, 100, 125, 150, 200, 250],
            '68': [100, 125, 150, 200, 250],
            '69': [100, 125, 150, 200, 250],
            '80': [100, 125, 150, 200, 250, 300],
            '81': [100, 125, 150, 200, 250, 300],
            'K80': [150, 200, 250, 300],
            'R80': [150, 200, 250, 300],
            'K88': [150, 200, 250, 300, 350],
            'R88': [150, 200, 250, 300, 350],
            'K90': [150, 200, 250, 300, 350, 400, 500],
            'R90': [150, 200, 250, 300, 350, 400, 500],
            'K91': [150, 200, 250, 300, 350, 400, 500],
        };
        
        // 生成推荐方案
        function generateRecommendations(baseLoad, heightReq, applicationScenario, environment) {
            const logoUrl = './logo-watermark.png';
            // 3D模型链接映射表
            const bracket3DLinks = {
                '30': 'https://3d.casterpartner.com/model/show_299.html',
                '33': 'https://3d.casterpartner.com/model/show_257.html',
                '42': 'https://3d.casterpartner.com/model/show_407.html',
                '46': 'https://3d.casterpartner.com/model/show_427.html',
                '56': 'https://3d.casterpartner.com/model/show_452.html',
                '51': 'https://3d.casterpartner.com/model/show_736.html',
                '63': 'https://3d.casterpartner.com/model/show_738.html',
                'K63': 'https://3d.casterpartner.com/model/show_738.html',
                'N63': 'https://3d.casterpartner.com/model/show_738.html',
                '68': 'https://3d.casterpartner.com/model/show_737.html',
                'R63': 'https://3d.casterpartner.com/model/show_203.html',
                '69': 'https://3d.casterpartner.com/model/show_245.html',
                '80': 'https://3d.casterpartner.com/model/show_232.html',
                '81': 'https://3d.casterpartner.com/model/show_232.html',
                'K80': 'https://3d.casterpartner.com/model/show_739.html',
                'R80': 'https://3d.casterpartner.com/model/show_739.html',
                'K90': 'https://3d.casterpartner.com/model/show_740.html',
                'R90': 'https://3d.casterpartner.com/model/show_740.html',
                'K88': 'https://3d.casterpartner.com/model/show_741.html',
                'R88': 'https://3d.casterpartner.com/model/show_741.html',
                'K91': 'https://3d.casterpartner.com/model/show_615.html',
            };
            const schemesContainer = document.getElementById('schemes-container');
            schemesContainer.innerHTML = '';
            // 添加超大区域水印
            if (!schemesContainer.querySelector('.schemes-container-watermark-bg')) {
                const bg = document.createElement('div');
                bg.className = 'schemes-container-watermark-bg';
                schemesContainer.appendChild(bg);
                schemesContainer.style.position = 'relative';
            }
            // 三种方案载重
            const schemeLoads = [
                baseLoad, 
                baseLoad * 1.1, 
                baseLoad * 1.25
            ];
            const schemeNames = [
                "标准方案",
                "增强方案",
                "高强方案"
            ];
            const schemeDescriptions = [
                "满足基本载重需求，性价比高，适用于常规使用场景",
                "提供10%额外安全裕度，适用于频繁使用或中等强度场景",
                "提供25%额外安全裕度，适用于高强度、高频率或关键应用场景"
            ];
            const schemeBenefits = [
                [
                    "成本效益最大化，减少初始投资",
                    "满足标准工况需求，可靠性高",
                    "维护成本低，备件更换方便"
                ],
                [
                    "安全系数提升10%，延长设备寿命",
                    "适用于中等强度作业环境",
                    "减少意外停机风险"
                ],
                [
                    "安全系数提升25%，确保极端工况安全",
                    "适用于高强度连续作业环境",
                    "最大化设备使用寿命，降低总拥有成本"
                ]
            ];
            // 获取应用场景优化建议
            const scenarioOptimization = getScenarioOptimization(applicationScenario);
            // 收集所有方案的支架和轮子信息
            const schemes = schemeLoads.map((load, index) => {
                let schemeType = 'standard';
                if (index === 1) schemeType = 'enhanced';
                if (index === 2) schemeType = 'strong';
                let bracketSeriesArr = getBracketSeriesByLoad(load, schemeType);
                if (load > 25 && load <= 550) {
                    if (schemeType === 'standard') {
                        bracketSeriesArr = ["30", "33"];
                    } else if (schemeType === 'enhanced') {
                        bracketSeriesArr = ["46", "42"];
                    } else if (schemeType === 'strong') {
                        bracketSeriesArr = ["56"];
                    }
                }
                const brackets = bracketSeriesArr.map(s => bracketSeries.find(b => b.series === s)).filter(Boolean);
                return { brackets, load };
            });
            // 递增轮子直径逻辑放在渲染阶段
            const wheels = [];
            schemes.forEach((scheme, index) => {
                let { brackets, load } = scheme;
                let minDiameter = 0;
                if (index > 0 && wheels[index-1]) {
                    minDiameter = wheels[index-1].diameter;
                }
                // 默认主图为第一个
                let currentImgSeries = brackets[0]?.series;
                // 推荐轮子（按支架系列和载重，递增约束）
                let wheel = findBestWheelForBracketAndLoad(currentImgSeries, load, minDiameter);
                wheels.push(wheel);
                const suitableMaterials = filterMaterialsByScenario(applicationScenario, load, environment);
                const schemeCard = document.createElement('div');
                schemeCard.className = `scheme ${index === 1 ? 'recommended' : ''}`;
                let allSeries = [];
                let allSeriesDesc = '';
                if (load > 10000) {
                    allSeries = ["K91"];
                    allSeriesDesc = getBracketDesc(allSeries[0]);
                } else if (load > 3000) {
                    allSeries = ["K90", "R90"];
                    allSeriesDesc = getBracketDesc(allSeries[0]);
                } else if (load > 2000) {
                    allSeries = ["K88", "R88"];
                    allSeriesDesc = getBracketDesc(allSeries[0]);
                } else if (load > 1000) {
                    allSeries = ["K80", "R80"];
                    allSeriesDesc = getBracketDesc(allSeries[0]);
                } else if (load > 600) {
                    allSeries = ["80", "81"];
                    allSeriesDesc = getBracketDesc(allSeries[0]);
                } else if (load > 99 && load <= 550) {
                    allSeries = ["51", "63", "N63", "K63", "R63"];
                    if (load > 300) {
                        allSeries = allSeries.filter(s => s !== "51");
                    }
                    allSeriesDesc = getBracketDesc(allSeries[0]);
                } else if (load > 24 && load <= 99) {
                    allSeries = ["30", "33", "42", "46", "56"];
                    allSeriesDesc = getBracketDesc(allSeries[0]);
                } else if (load <= 24) {
                    allSeries = ["30", "33", "42", "46", "56"];
                    allSeriesDesc = getBracketDesc(allSeries[0]);
                } else {
                    allSeries = brackets.map(b=>b.series);
                    allSeriesDesc = getBracketDesc(allSeries[0]);
                }
                // 默认主图为第一个
                let mainImgSeries = allSeries[0];
                let mainImgUrl = bracketSeries.find(b => b.series === mainImgSeries)?.imageUrl || '';
                // 3D模型链接
                let main3DLink = bracket3DLinks[mainImgSeries] || '';
                schemeCard.innerHTML = `
                    <div style=\"position:relative;text-align:center;margin-bottom:10px;\">
                        <img id=\"main-img-${index}\" src=\"${mainImgUrl}\" alt=\"主产品图\" style=\"width:180px;max-width:220px;height:120px;object-fit:cover;border-radius:8px;box-shadow:0 2px 8px #eee;margin:0 10px;cursor:pointer;\">
                        ${main3DLink ? `<a href=\"${main3DLink}\" class=\"main-3d-link\" target=\"_blank\" style=\"display:inline-block;margin-left:8px;vertical-align:middle;\"><i class=\"fas fa-cube\"></i> 3D模型</a>` : `<a class=\"main-3d-link\" style=\"display:none\"></a>`}
                        <img src=\"${logoUrl}\" alt=\"logo水印\" style=\"position:absolute;right:8px;bottom:calc(8px + 5cm);transform:rotate(180deg) scaleX(-1);width:90px;height:40px;opacity:0.18;z-index:2;pointer-events:none;user-select:none;\">
                    </div>
                    <h3 style=\"display:flex;align-items:center;justify-content:space-between;\">${schemeNames[index]}
                    </h3>
                    <p style=\"color: #4a5568; margin-bottom: 12px; font-size: 0.9rem;\">${schemeDescriptions[index]}</p>
                    <div style=\"margin-bottom:2px;font-weight:600;color:#2d3748;font-size:0.95rem;\">支架类型:</div>
                    <div style=\"display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:center;margin-bottom:6px;\">
                        ${allSeries.map((series,i) => {
                            const b = bracketSeries.find(b=>b.series===series);
                            return `<button class=\"series-btn-${index} ${i===0?'selected-bracket-text':''}\" data-series=\"${series}\" data-img=\"${b?.imageUrl||''}\" style=\"cursor:pointer;padding:2px 10px;border-radius:6px;font-weight:bold;font-size:1.02rem;color:#2b6cb0;border:1px solid #cbd5e0;background:#f8fafc;transition:background 0.2s;\">${series}</button>`;
                        }).join('')}
                        <span style=\"color:#888;font-size:0.95rem;margin-left:8px;\">(${allSeriesDesc})</span>
                    </div>
                    <div class=\"scheme-content\"> 
                        <ul>
                            <li><strong>轮子直径:</strong> ${wheel ? `${wheel.diameter}mm` : '--'}</li>
                            <li><strong>单轮载重:</strong> <span style=\"font-weight: bold; color: #2b6cb0;\">${load.toFixed(2)} kg</span></li>
                            <li><strong>总高度:</strong> ${wheel ? getWheelHeightRange(wheel.diameter) : '--'}
                                ${(() => {
                                    if (!wheel || !heightReq) return '';
                                    const h = wheel.diameter * 1.4;
                                    const diff = Math.abs(h - heightReq);
                                    const percent = ((diff / heightReq) * 100).toFixed(0);
                                    if (percent <= 10) {
                                        return `<span class=\"height-match\"><i class=\"fas fa-check-circle\"></i> 高度匹配 (${percent}% 差异)</span>`;
                                    } else {
                                        return `<span class=\"height-warning\"><i class=\"fas fa-exclamation-circle\"></i> 高度警告 (${percent}% 差异)</span>`;
                                    }
                                })()}
                            </li>
                        </ul>
                        <div class=\"material-options\" style=\"position:relative;\"> 
                            <h5 style=\"display:flex;align-items:center;justify-content:space-between;\"><i class=\"fas fa-layer-group\"></i> 推荐材质
                            </h5>
                            <div class=\"material-grid\"> 
                                ${(() => {
                                    let mats = suitableMaterials.slice(0, 2);
                                    if (mats.length === 0) {
                                        mats = [
                                            { name: '暂无推荐', hardness: '——', desc: '当前条件下暂无合适材质推荐', rollingResistance: 0, wearResistance: 0, floorProtection: 0, noise: 0, advantages: '建议调整参数或联系客服', disadvantages: '需要进一步评估' },
                                            { name: '暂无推荐', hardness: '——', desc: '当前条件下暂无合适材质推荐', rollingResistance: 0, wearResistance: 0, floorProtection: 0, noise: 0, advantages: '建议调整参数或联系客服', disadvantages: '需要进一步评估' }
                                        ];
                                    } else if (mats.length === 1) {
                                        mats = [mats[0], {...mats[0]}];
                                    }
                                    mats = mats.slice(0, 2);
                                    return mats.map(m => generateMaterialCard(m)).join('');
                                })()}
                            </div>
                        </div>
                        <div class=\"scheme-benefits\">\n                            <h4 style=\"display:flex;align-items:center;justify-content:space-between;\"><i class=\"fas fa-check-circle\"></i> 方案优势
                            </h4>
                            ${schemeBenefits[index].map(benefit => `
                                <div class=\"benefit-item\">\n                                    <i class=\"fas fa-check\"></i>\n                                    <div>${benefit}</div>\n                                </div>
                            `).join('')}
                            <div style=\"margin-top: 10px; border-top: 1px dashed #cbd5e0; padding-top: 8px;\">\n                                <h4><i class=\"fas fa-lightbulb\"></i> ${scenarioOptimization.title}</h4>\n                                ${scenarioOptimization.tips.map(tip => `
                                    <div class=\"benefit-item\">\n                                        <i class=\"fas fa-angle-right\"></i>\n                                        <div>${tip}</div>\n                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
                schemesContainer.appendChild(schemeCard);
                // 切换主图和轮子
                setTimeout(() => {
                    const btns = schemeCard.querySelectorAll(`.series-btn-${index}`);
                    const mainImg = schemeCard.querySelector(`#main-img-${index}`);
                    btns.forEach(btn => {
                        btn.addEventListener('click', function() {
                            const imgUrl = this.getAttribute('data-img');
                            const series = this.getAttribute('data-series');
                            mainImg.src = imgUrl;
                            btns.forEach(b=>b.classList.remove('selected-bracket-text'));
                            this.classList.add('selected-bracket-text');
                            // 切换3D模型链接
                            const link = schemeCard.querySelector('.main-3d-link');
                            if(link){
                                const new3D = bracket3DLinks[series] || '';
                                if(new3D){
                                    link.href = new3D;
                                    link.style.display = 'inline-block';
                                }else{
                                    link.removeAttribute('href');
                                    link.style.display = 'none';
                                }
                            }
                            // 切换轮子
                            const newWheel = findBestWheelForBracketAndLoad(series, load);
                            const ul = schemeCard.querySelector('ul');
                            if (ul && newWheel) {
                                ul.children[0].innerHTML = `<strong>轮子直径:</strong> ${newWheel.diameter}mm`;
                                ul.children[2].innerHTML = `<strong>总高度:</strong> ${getWheelHeightRange(newWheel.diameter)}${(() => {
                                    if (!heightReq) return '';
                                    const h = newWheel.diameter * 1.4;
                                    const diff = Math.abs(h - heightReq);
                                    const percent = ((diff / heightReq) * 100).toFixed(0);
                                    if (percent <= 10) {
                                        return `<span class=\"height-match\"><i class=\"fas fa-check-circle\"></i> 高度匹配 (${percent}% 差异)</span>`;
                                    } else {
                                        return `<span class=\"height-warning\"><i class=\"fas fa-exclamation-circle\"></i> 高度警告 (${percent}% 差异)</span>`;
                                    }
                                })()}`;
                            }
                        });
                    });
                    // 支架图片点击跳转3D
                    if(mainImg){
                        mainImg.addEventListener('click', function(){
                            const curSeriesBtn = schemeCard.querySelector('.series-btn-' + index + '.selected-bracket-text');
                            const curSeries = curSeriesBtn ? curSeriesBtn.getAttribute('data-series') : mainImgSeries;
                            const link = bracket3DLinks[curSeries] || '';
                            if(link){
                                window.open(link, '_blank');
                            }
                        });
                    }
                }, 0);
            });
        }
        
        // 生成图片按钮事件
        document.getElementById('generate-btn').addEventListener('click', function() {
            // 只截取推荐方案区域
            const resultSection = document.querySelector('.result-section');
            // 1. 强制所有方案卡片内logo水印（img[alt='logo水印']）全显且不透明
            const logoImgs = Array.from(resultSection.querySelectorAll("img[alt='logo水印']"));
            // 记录原样式
            const logoOriginalStyles = logoImgs.map(img => ({
                opacity: img.style.opacity,
                pointerEvents: img.style.pointerEvents,
                userSelect: img.style.userSelect,
                filter: img.style.filter
            }));
            logoImgs.forEach(img => {
                img.style.opacity = '1';
                img.style.pointerEvents = 'auto';
                img.style.userSelect = 'auto';
                img.style.filter = '';
            });
            // 2. 额外添加3个大水印logo（如原逻辑）
            const logoUrl = './logo-watermark.png';
            const watermarks = [];
            const sectionRect = resultSection.getBoundingClientRect();
            const logoWidth = sectionRect.width * 0.32;
            const logoHeight = logoWidth * 0.18;
            const positions = [
                {top: '2%', left: '60%'},
                {top: '38%', left: '32%'},
                {top: '74%', left: '4%'}
            ];
            positions.forEach((pos, i) => {
                const img = document.createElement('img');
                img.src = logoUrl;
                img.alt = 'logo水印';
                img.style.position = 'absolute';
                img.style.pointerEvents = 'none';
                img.style.userSelect = 'none';
                img.style.opacity = '0.18';
                img.style.width = logoWidth + 'px';
                img.style.height = logoHeight + 'px';
                img.style.top = pos.top;
                img.style.left = pos.left;
                img.style.transform = 'rotate(-45deg)';
                img.style.zIndex = '1';
                img.className = 'screenshot-watermark-logo';
                resultSection.appendChild(img);
                watermarks.push(img);
            });
            // 3. 截图
            html2canvas(resultSection, {
                scale: 2,
                useCORS: true
            }).then(canvas => {
                // 4. 移除额外水印logo
                watermarks.forEach(img => img.remove());
                // 5. 还原所有logo水印样式
                logoImgs.forEach((img, i) => {
                    const style = logoOriginalStyles[i];
                    img.style.opacity = style.opacity;
                    img.style.pointerEvents = style.pointerEvents;
                    img.style.userSelect = style.userSelect;
                    img.style.filter = style.filter;
                });
                const imgData = canvas.toDataURL('image/png');
                // 创建下载链接
                const link = document.createElement('a');
                const dateStr = new Date().toISOString().slice(0, 10).replace(/-/g, '');
                link.download = `江龙脚轮选型方案_${dateStr}.png`;
                link.href = imgData;
                link.click();
            });
        });
        
        // 复制话术按钮事件
        document.getElementById('copy-btn').addEventListener('click', function() {
            const schemeElements = document.querySelectorAll('.scheme');
            const applicationScenario = document.getElementById('application-scenario').value;
            const environment = document.getElementById('environment').value;
            const scenarioText = getScenarioDescription(applicationScenario);
            
            
            let copyText = "【江龙脚轮选型方案】\n\n";
            copyText += `应用场景: ${scenarioText}\n\n`;
            
            schemeElements.forEach((scheme, index) => {
                const title = scheme.querySelector('h3').textContent;
                const totalHeight = scheme.querySelector('li:nth-child(5)').textContent;
                const loadCapacity = scheme.querySelector('ul li:nth-child(2)')?.textContent || '';
                const heightDiff = scheme.querySelector('.height-match, .height-warning')?.textContent || '';
                const keyBenefits = Array.from(scheme.querySelectorAll('.benefit-item div'))
                    .slice(0, 3)
                    .map(div => `✓ ${div.textContent}`)
                    .join('\n');
                
                copyText += `【${title}】\n`;
                copyText += `${loadCapacity}\n`;
                copyText += `${totalHeight}\n`;
                copyText += `核心优势:\n${keyBenefits}\n\n`;
            });
            
            
            // 复制到剪贴板
            navigator.clipboard.writeText(copyText).then(() => {
                alert('专业推荐话术已复制到剪贴板！');
            });
        });
        
        // 单轮类型选择事件
        document.querySelectorAll('.type-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.type-option').forEach(el => {
                    el.classList.remove('selected');
                });
                this.classList.add('selected');
                const radio = this.querySelector('input[type="radio"]');
                radio.checked = true;
            });
        });
        
        // 确保DOM加载完成后执行初始计算
        document.addEventListener('DOMContentLoaded', function() {
            setupImageErrorHandlers();
            setTimeout(() => {
                const calculateBtn = document.getElementById('calculate-btn');
                if (calculateBtn) {
                    calculateBtn.click();
                    updateDateTime();
                } else {
                    console.error('计算按钮未找到，无法自动触发计算');
                }
            }, 1000); // 适当缩短延迟时间
        });
        
        // 监听"使用环境"变化，自动触发计算
        document.getElementById('environment').addEventListener('change', function() {
            document.getElementById('calculate-btn').click();
        });
        
        // 为所有外部图片添加错误处理
        function setupImageErrorHandlers() {
            // 替换为caster-site版本的图片处理逻辑
            // 1. 更新bracketSeries中的图片链接为free.picui.cn格式
            bracketSeries.forEach(series => {
                // 已手动更新所有链接，保留此代码仅用于处理旧的superbed链接
                if (series.imageUrl && series.imageUrl.includes('free.superbed.cn')) {
                    // 提取文件名
                    const fileName = series.imageUrl.split('/').pop();
                    // 生成新的free.picui.cn链接
                    series.imageUrl = `https://free.picui.cn/free/2025/08/20/${fileName}`;
                }
                // 处理imageHtml属性
                if (series.imageHtml) {
                    // 替换为free.picui.cn链接
                    series.imageHtml = series.imageHtml.replace(/src="https:\/\/free\.superbed\.cn\/store\/images\//g, 'src="https://free.picui.cn/free/2025/08/20/');
                    // 添加onerror属性
                    series.imageHtml = series.imageHtml.replace(/<img/g, '<img onerror="handleImageError(this)"');
                }
            });
        }

        // 图片错误处理函数
        function handleImageError(img, fallbackSrc) {
            console.error(`图片加载失败: ${img.src}`);
            img.onerror = null; // 防止无限循环

            // 如果图片还没有尝试过重试，则进行重试
            if (!img.dataset.retryAttempted) {
                img.dataset.retryAttempted = 'true';
                
                // 添加时间戳避免缓存问题
                const separator = img.src.includes('?') ? '&' : '?';
                const retrySrc = `${img.src}${separator}t=${Date.now()}`;
                console.log(`尝试重新加载图片: ${retrySrc}`);
                
                img.src = retrySrc;
                img.onerror = function() {
                    console.error(`重试后图片仍加载失败: ${retrySrc}`);
                    // 最终失败，显示默认图片
                    img.src = fallbackSrc || 'data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22180%22%20height%3D%22120%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Crect%20width%3D%22180%22%20height%3D%22120%22%20fill%3D%22%23f0f0f0%22%2F%3E%3Ctext%20x%3D%2290%22%20y%3D%2260%22%20text-anchor%3D%22middle%22%20fill%3D%22%23999%22%20font-family%3D%22Arial%22%20font-size%3D%2212%22%3E图片加载失败%3C%2Ftext%3E%3C%2Fsvg%3E';
                    img.style.border = '1px solid #ddd';
                };
            } else {
                // 已经重试过，显示默认图片
                img.src = fallbackSrc || 'data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22180%22%20height%3D%22120%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Crect%20width%3D%22180%22%20height%3D%22120%22%20fill%3D%22%23f0f0f0%22%2F%3E%3Ctext%20x%3D%2290%22%20y%3D%2260%22%20text-anchor%3D%22middle%22%20fill%3D%22%23999%22%20font-family%3D%22Arial%22%20font-size%3D%2212%22%3E图片加载失败%3C%2Ftext%3E%3C%2Fsvg%3E';
                img.style.border = '1px solid #ddd';
            }
        }

        // 3. 更新logo图片链接
        const logoUrl = './logo-watermark.png';
        document.querySelectorAll('img[alt="logo水印"]').forEach(img => {
            img.src = logoUrl;
            img.onerror = function() {
                handleImageError(this);
            };
        });

        
        // 新增：监听所有参数输入栏的input和select变化，自动触发计算
        document.querySelectorAll('.input-section input, .input-section select').forEach(el => {
            el.addEventListener('input', function() {
                document.getElementById('calculate-btn').click();
            });
            el.addEventListener('change', function() {
                document.getElementById('calculate-btn').click();
            });
        });

        // 支架系列类型描述函数
        function getBracketDesc(series) {
            if (["30","33","42","46","56"].includes(series)) return "中重型商用脚轮支架";
            if (["51","63","K63","N63","R63","69","68"].includes(series)) return "重型工业脚轮支架";
            if (["80","81","K80","R80","K88","R88","K90","R90","K91"].includes(series)) return "超重型工业脚轮支架";
            return "工业脚轮支架";
        }
        // 计算轮子高度（1.4倍直径）
        function getWheelHeightRange(diameter) {
            return `${Math.round(diameter * 1.4)} mm`;
        }
    </script>



    <script>
      // 统一更新footer中的visitor-counter-pos（不再使用pv-count）
      document.addEventListener('DOMContentLoaded', function() {
        const counterElement = document.getElementById('visitor-counter-pos');
        if (!counterElement) {
          console.error('未找到footer中的访问量显示元素（visitor-counter-pos）');
          return;
        }

        // 初始化显示加载中
        counterElement.textContent = '加载中...';

        // LeanCloud统计核心逻辑
        if (typeof AV === 'undefined') {
          console.warn('LeanCloud SDK未加载，使用本地统计');
          try {
            const pvKey = 'jl_visits';
            let count = parseInt(localStorage.getItem(pvKey) || '16000') + 1;
            localStorage.setItem(pvKey, count);
            counterElement.textContent = count.toLocaleString('zh-CN');
          } catch (e) {
            counterElement.textContent = '1'; // 内存临时计数
            console.error('本地存储失败:', e);
          }
          return;
        }

        // LeanCloud云端统计（关联VisitCounter表）
        try {
          const VisitCounter = AV.Object.extend('VisitCounter');
          const query = new AV.Query(VisitCounter);

        // 查总访问量记录，无则创建
        query.equalTo('type', 'total').first().then(record => {
          if (record) {
            record.increment('count', 1); // 原子递增，防并发
            return record.save();
          } else {
            return new VisitCounter({ type: 'total', count: 16000 }).save();
          }
        }).then(savedRecord => {
          const cloudCount = savedRecord.get('count');
          counterElement.textContent = cloudCount.toLocaleString('zh-CN');
        }).catch(error => {
          console.error('云端统计失败，降级本地', error);
          // 降级显示本地计数
          const localCount = parseInt(localStorage.getItem('jl_visits') || '16000') + 1;
          localStorage.setItem('jl_visits', localCount);
            counterElement.textContent = localCount.toLocaleString('zh-CN');
          });
        } catch (e) {
          counterElement.textContent = '统计错误';
          console.error('统计逻辑异常:', e);
        }
      });
      </script>

</body>



<!-- 计数器容器（预留，自 jsq.html 要求） -->
<div id="page-visit-counter" style="display:none"></div>



</html>